<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Mobile Photo Album</title>

  <style>
    :root{
      --bg: #f7f8fb;
      --card: rgba(255,255,255,.78);
      --stroke: rgba(0,0,0,.09);
      --text: #111827;
      --muted: #6b7280;
      --shadow: 0 18px 40px rgba(0,0,0,.08);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 10% 10%, #ffe4ef, transparent 60%),
        radial-gradient(800px 600px at 90% 20%, #e6f0ff, transparent 60%),
        radial-gradient(700px 600px at 50% 90%, #e8fff4, transparent 60%),
        var(--bg);
      font-family: ui-sans-serif, system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow-x:hidden;
    }

    .safe{
      padding: calc(env(safe-area-inset-top) + 18px) 16px calc(env(safe-area-inset-bottom) + 18px);
      max-width: 980px;
      margin: 0 auto;
    }

    header{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:12px;
      margin-bottom:14px;
    }

    .title{
      margin:0;
      font-size:24px;
      font-weight:720;
      letter-spacing:-0.02em;
    }

    .subtitle{
      margin:4px 0 0;
      font-size:13px;
      color:var(--muted);
    }

    .pill{
      background: rgba(255,255,255,.72);
      border:1px solid var(--stroke);
      border-radius: 0;                 /* 라운드 제거 */
      padding:8px 12px;
      font-size:12px;
      color:#374151;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
    }

    /* ===== Grid (thumbnails) ===== */
    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-top:14px;
    }
    @media (min-width: 520px){
      .grid{ grid-template-columns: repeat(4, 1fr); }
      .title{ font-size:28px; }
    }

    .tile{
      position:relative;
      aspect-ratio:1/1;
      border-radius:0;                  /* 라운드 제거 */
      overflow:hidden;
      border:1px solid var(--stroke);
      background:#fff;
      box-shadow: var(--shadow);
      cursor:pointer;
      transition: transform .16s ease;
      -webkit-tap-highlight-color: transparent;
    }
    .tile:active{ transform: scale(.98); }

    /* 그리드는 통일감 위해 cover */
    .tile img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

   

    /* ===== Viewer ===== */
    .viewer{
      position:fixed;
      inset:0;
      display:none;
      background: rgba(255,255,255,.78);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      z-index:999;
    }
    .viewer.open{ display:block; }

    .viewer-top{
      position:absolute;
      top:0; left:0; right:0;
      padding: calc(env(safe-area-inset-top) + 10px) 14px 10px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      pointer-events:auto;
    }

    .btn{
      background:#fff;
      border:1px solid var(--stroke);
      border-radius:0;                  /* 라운드 제거 */
      padding:9px 14px;
      font-size:13px;
      color:#111827;
      box-shadow: var(--shadow);
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: scale(.98); }

    .counter{
      font-size:13px;
      color:#374151;
      background: rgba(255,255,255,.72);
      border:1px solid var(--stroke);
      padding:8px 12px;
      border-radius:0;                  /* 라운드 제거 */
      box-shadow: var(--shadow);
      user-select:none;
      white-space:nowrap;
    }

    .carousel{
      position:absolute;
      inset:0;
      display:flex;
      overflow-x:auto;
      scroll-snap-type:x mandatory;
      -webkit-overflow-scrolling:touch;
      scrollbar-width:none;
    }
    .carousel::-webkit-scrollbar{ display:none; }

    .slide{
      flex:0 0 100%;
      scroll-snap-align:center;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      padding: calc(env(safe-area-inset-top) + 64px) 16px calc(env(safe-area-inset-bottom) + 140px);
      gap:14px;
    }

    /* 프레임은 "가로/세로 섞여도" 꽉 차게 담아주는 컨테이너 */
    .frame{
      width:min(94vw, 760px);
      height: min(62vh, 620px);        /* 높이 기반으로 크게 보여줌 */
      border-radius:0;                  /* 라운드 제거 */
      overflow:hidden;
      background:#fff;
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* 핵심: 큰 화면은 contain(원본 비율 유지, 안 잘림) */
    .frame img{
      width:100%;
      height:100%;
      object-fit:contain;               /* ✅ 가로/세로 자동 대응 */
      background:#fff;                  /* 남는 여백은 흰색 */
      display:block;
      -webkit-user-drag:none;
      user-select:none;
    }

    .caption{
      width:min(94vw, 760px);
      background: rgba(255,255,255,.88);
      border-radius:0;                  /* 라운드 제거 */
      padding:14px 16px;
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
    }
    .caption p{
      margin:0;
      font-size:15px;
      letter-spacing:-0.01em;
    }
    .caption small{
      display:block;
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
    }

    .viewer-bottom{
      position:absolute;
      left:0; right:0; bottom:0;
      padding: 10px 14px calc(env(safe-area-inset-bottom) + 10px);
      display:flex;
      justify-content:space-between;
      gap:12px;
      align-items:center;
    }

    .dots{
      display:flex;
      gap:6px;
      max-width: 72vw;
      overflow:hidden;
    }
    .dot{
      width: 7px;
      height: 7px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(0,0,0,.12);
      border-radius: 0;                 /* 라운드 제거 */
      transition: width .2s ease, background .2s ease;
      flex: 0 0 auto;
    }
    .dot.active{
      width: 18px;
      background: rgba(0,0,0,.78);
    }

    .hint{
      font-size:12px;
      color: rgba(0,0,0,.45);
      user-select:none;
      white-space:nowrap;
    }
  </style>
</head>

<body>
  <div class="safe">
    <header>
      <div>
        <h1 class="title">Spring Memories</h1>
        <p class="subtitle">12 moments, softly collected</p>
      </div>
      <div class="pill">tap photo</div>
    </header>

    <section class="grid" id="grid"></section>
  </div>

  <!-- Viewer -->
  <div class="viewer" id="viewer" aria-hidden="true">
    <div class="viewer-top">
      <button class="btn" id="closeBtn">닫기</button>
      <div class="counter" id="counter">1 / 12</div>
      <button class="btn" id="gridBtn">그리드</button>
    </div>

    <div class="carousel" id="carousel"></div>

    <div class="viewer-bottom">
      <div class="dots" id="dots"></div>
      <div class="hint">← → swipe</div>
    </div>
  </div>

<script>
  // 사진 경로/캡션만 바꾸면 됨
  const PHOTOS = [
    { src: "images/01.jpg", text: "여름휴가 때 송도 바닷가 여행", meta: "memory" },
    { src: "images/02.jpg", text: "마음이 편해지는 부산근현대역사박물관", meta: "memory" },
    { src: "images/03.jpg", text: "너무 더웠던 8월의 광안리 해수욕장", meta: "memory" },
    { src: "images/04.jpg", text: "여름휴가 시작과 함께 책 사러갔던 책방골목", meta: "memory" },
    { src: "images/05.jpg", text: "책방골목에서 세린이", meta: "memory" },
    { src: "images/06.jpg", text: "5월에는 도쿄타워", meta: "memory" },
    { src: "images/07.jpg", text: "4월에는 순천 구례", meta: "memory" },
    { src: "images/08.jpg", text: "사진이 왜 또들어갔지", meta: "memory" },
    { src: "images/09.jpg", text: "도쿄타워 앞에서 세린이랑", meta: "memory" },
    { src: "images/10.jpg", text: "여기 어디더라 이름이..", meta: "memory" },
    { src: "images/11.jpg", text: "땀뻘뻘 용두산 공원 추억 여행", meta: "memory" },
    { src: "images/12.jpg", text: "아메리칸 드림", meta: "memory" },
  ];

  const grid = document.getElementById("grid");
  const viewer = document.getElementById("viewer");
  const carousel = document.getElementById("carousel");
  const counter = document.getElementById("counter");
  const dots = document.getElementById("dots");
  const closeBtn = document.getElementById("closeBtn");
  const gridBtn = document.getElementById("gridBtn");

  let currentIndex = 0;

  // Grid
  PHOTOS.forEach((p, i) => {
    const tile = document.createElement("button");
    tile.className = "tile";
    tile.type = "button";
    tile.innerHTML = `
      <img src="${p.src}" alt="photo ${i+1}" loading="lazy">
      
    `;
    tile.addEventListener("click", () => openViewer(i));
    grid.appendChild(tile);
  });

  // Slides + Dots
  PHOTOS.forEach((p, i) => {
    const slide = document.createElement("div");
    slide.className = "slide";
    slide.dataset.index = i;
    slide.innerHTML = `
      <div class="frame"><img src="${p.src}" alt="photo ${i+1}" draggable="false"></div>
      <div class="caption">
        <p>${escapeHtml(p.text || "")}</p>
        <small>${escapeHtml(p.meta || "")}</small>
      </div>
    `;
    carousel.appendChild(slide);

    const dot = document.createElement("div");
    dot.className = "dot";
    dot.addEventListener("click", () => scrollToIndex(i));
    dots.appendChild(dot);
  });

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function openViewer(i){
    currentIndex = i;
    viewer.classList.add("open");
    viewer.setAttribute("aria-hidden","false");
    document.body.style.overflow = "hidden";
    requestAnimationFrame(() => {
      scrollToIndex(i, false);
      updateUI(i);
    });
  }

  function closeViewer(){
    viewer.classList.remove("open");
    viewer.setAttribute("aria-hidden","true");
    document.body.style.overflow = "";
  }

  closeBtn.addEventListener("click", closeViewer);
  gridBtn.addEventListener("click", () => {
    closeViewer();
    setTimeout(() => grid.scrollIntoView({behavior:"smooth", block:"start"}), 50);
  });

  function scrollToIndex(i, smooth=true){
    const slide = carousel.querySelector(`.slide[data-index="${i}"]`);
    if(!slide) return;
    currentIndex = i;
    slide.scrollIntoView({behavior: smooth ? "smooth" : "auto", inline:"center", block:"nearest"});
    updateUI(i);
  }

  function updateUI(i){
    counter.textContent = `${i+1} / ${PHOTOS.length}`;
    [...dots.children].forEach((d, idx) => d.classList.toggle("active", idx===i));
  }

  // Scroll index detect
  let ticking = false;
  carousel.addEventListener("scroll", () => {
    if(!viewer.classList.contains("open")) return;
    if(ticking) return;
    ticking = true;
    requestAnimationFrame(() => {
      const idx = getNearestIndex();
      if(idx !== currentIndex){
        currentIndex = idx;
        updateUI(idx);
      }
      ticking = false;
    });
  });

  function getNearestIndex(){
    const slides = [...carousel.querySelectorAll(".slide")];
    const center = carousel.scrollLeft + carousel.clientWidth / 2;
    let best = 0, bestDist = Infinity;

    slides.forEach((s, i) => {
      const mid = s.offsetLeft + s.clientWidth / 2;
      const dist = Math.abs(mid - center);
      if(dist < bestDist){
        bestDist = dist;
        best = i;
      }
    });
    return best;
  }

  // init
  updateUI(0);
</script>
</body>
</html>
